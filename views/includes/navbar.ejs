<div class="navbackgound position-relative">
  <div class="custom-center-div">
    <div class="row">
      <div class="col ms-auto navbackgound my-3"><a href="/"><img src="/img/logo.png" id="logo" alt="logo"></a></div>
      <div class="col mr-auto text-end d-flex justify-content-end">
        <nav class="navbar navbar-dark align-items-center">
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarToggleExternalContent" aria-controls="navbarToggleExternalContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="d-none d-sm-none d-md-block">Menu</span>
            <span class="navbar-toggler-icon"></span>
          </button>
        </nav>
      </div>
    </div>
    <div class="collapse navbar-expand-lg" id="navbarToggleExternalContent">
      <div class="navbar-collapse bg-dark p-3">
        <ul class="navbar-nav me-auto mb-2 mb-lg-0">
          <l1 class="nav-item d-none d-lg-block"><label class="nav-link fs-4 popover-user colorlight" data-bs-toggle="popover">User</label></l1>
          <l1 class="nav-item d-none d-lg-block"><label class="nav-link fs-4 popover-articles colorlight" data-bs-toggle="popover">Articles</label></l1>
          <li class="nav-item"><a class="nav-link colorlight fs-4 d-lg-none d-md-block" href="/articles">Articles</a></li>
          <li class="nav-item"><a class="nav-link colorlight fs-4 d-lg-none d-md-block" href="/about">About</a></li>
          <%if(params.page != 'error') {
            if(params.logged) {  %>
              <li class="nav-item"><a class="nav-link colorlight fs-4 d-lg-none d-md-block" href="/profile">Profile</a></li>
              <li class="nav-item"><a class="nav-link colorlight fs-4 d-lg-none d-md-block" href="/logout">Logout</a></li>
            <%} else {  %>  
              <li class="nav-item"><a class="nav-link colorlight fs-4 d-lg-none d-md-block" href="/login">Login</a></li>
              <li class="nav-item"><a class="nav-link colorlight fs-4 d-lg-none d-md-block" href="/register">Sign up</a></li>
          <% } }%>
        </ul>
        <% if(params.logged) { %>
          <a class="navbar-text fs-6 colorlight" href="/profile"><i><%= params.user.email %></i></a>
        <% } %>
      </div>
    </div>
  </div>
</div>


<script>
  let contentUser = ` <% if(params.logged) { %> 
    <div class="row">
      <div class="col-4 ms-4">
        <div class="row mt-3"><p class="fs-5 text-dark">Profile</p></div>
        <div class="row"><p class="fs-7 text-black-50">View your profile and edit it to your liking, maybe add a bio.</p></div>
        <div class="row"><div><a href="/profile" class="btn btn-outline-secondary me-2 mb-3">Profile</a></div></div>
        <div class="row mt-3"><p class="fs-5 text-dark">About</p></div>
        <div class="row"><p class="fs-7 text-black-50">Here you will find information about the developer.</p></div> 
      </div>
      <div class="col-4 ms-4">
        <div class="row mt-3"><p class="fs-5 text-dark">Logout</p></div>
        <div class="row"><p class="fs-7 text-black-50">Hey, <%=params.user.email%> are you going to go out? Click the button below.</p></div>
        <div class="row"><div><a href="/logout" class="btn btn-outline-secondary me-2 mb-3">Logout</a></div></div> 
        <div class="row mt-5"><div class="mt-3"><a href="/about" class="btn btn-outline-secondary me-2 mb-3">About</a></div></div> 
      </div>
      <div class="col text-end">
        <img src="/img/popover.png" height="340px" width="115px">
      </div>
    </div>
  <% } else { %> 
    <div class="row">
      <div class="col-4 ms-4">
        <div class="row mt-3"><p class="fs-5 text-dark">Log in</p></div>
        <div class="row"><p class="fs-7 text-black-50">Enter for the ultimate experience, new articles are waiting for you!</p></div>
        <div class="row"><div><a href="/login" class="btn btn-outline-secondary me-2 mb-3">Login</a></div></div>
        <div class="row mt-3"><p class="fs-5 text-dark">About</p></div>
        <div class="row"><p class="fs-7 text-black-50">Here you will find information about the developer.</p></div> 
      </div>
      <div class="col-4 ms-4">
        <div class="row mt-3"><p class="fs-5 text-dark">Sign up</p></div>
        <div class="row"><p class="fs-7 text-black-50">Not registered? Hit the button below and enter the world of Hackerfill.</p></div>
        <div class="row"><div><a href="/register" class="btn btn-outline-secondary me-2 mb-3">Sign in</a></div></div> 
        <div class="row mt-5"><div class="mt-3"><a href="/about" class="btn btn-outline-secondary me-2 mb-3">About</a></div></div> 
      </div>
      <div class="col text-end">
        <img src="/img/popover.png" height="340px" width="115px">
      </div>
    </div>
  <% } %>`; 

  let contentArticles = `
    <div class="row">
      <div class="col-4 ms-4">
        <div class="row mt-3"><p class="fs-5 text-dark">Read an article</p></div>
        <div class="row"><p class="fs-7 text-black-50">See if anything new has come out, you might be interested.</p></div>
        <div class="row"><div><a href="/articles" class="btn btn-outline-secondary me-2 mb-3">Read</a></div></div>
        <div class="row mt-3"><p class="fs-5 text-dark">Write an review</p></div>
        <div class="row"><p class="fs-7 text-black-50">Remember to review the items, to ascertain their quality.</p></div> 
      </div>
      <div class="col-4 ms-4">
        <div class="row mt-3"><p class="fs-5 text-dark">Write an article</p></div>
        <div class="row"><p class="fs-7 text-black-50">Help the community by writing an article, you might like it.</p></div> 
        <div class="row"><div><a href="/articles/new" class="btn btn-outline-secondary me-2 mb-3 <% if(!params.logged || params.user.role != "advertiser") { %> disabled <% } %>">Write</a></div></div>
      </div>
      <div class="col text-end">
        <img src="/img/popover.png" height="340px" width="115px">
      </div>
    </div>
  `;

  var popoverUser = new bootstrap.Popover(document.querySelector('.popover-user'), {
    container: 'body',
    animation: true,
    offset: "215,0",
		trigger: 'manual',
		html: true,
		placement:'bottom',
		content: contentUser,
    template: '<div class="popover" role="tooltip"><div class="popover-arrow"></div><div class="popover-body p-0"></div></div>'
	});

  var popoverArticles = new bootstrap.Popover(document.querySelector('.popover-articles'), {
    container: 'body',
    animation: true,
    offset: "215,0",
		trigger: 'manual',
		html: true,
		placement:'bottom',
		content: contentArticles,
    template: '<div class="popover" role="tooltip"><div class="popover-arrow"></div><div class="popover-body p-0"></div></div>'
	});
	
	document.querySelector(".popover-user").addEventListener("mouseenter", (e) => {
		popoverUser.show();
    popoverArticles.hide();
		document.querySelector(".popover").addEventListener("mouseleave", (e) => {
			popoverUser.hide();
		});
	});
	document.querySelector(".popover-user").addEventListener("mouseleave", (e) => {
		setTimeout(() => {
			if(e.toElement.className.search("popover") == -1)
        popoverUser.hide();
		}, 100);
	});

  document.querySelector(".popover-articles").addEventListener("mouseenter", (e) => {
		popoverArticles.show();
    popoverUser.hide();
		document.querySelector(".popover").addEventListener("mouseleave", (e) => {
			popoverArticles.hide();
		});
	});
	document.querySelector(".popover-articles").addEventListener("mouseleave", (e) => {
		setTimeout(() => {
			if(e.toElement.className.search("popover") == -1)
        popoverArticles.hide();
		}, 100);
	});
</script>